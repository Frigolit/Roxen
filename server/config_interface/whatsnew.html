<!-- $B$$$=(B2022 $B$K$[$s$4(B -->
<topmenu selected="hype"/>
<content>
<charset in='iso-2022'>
<br />
<blockquote>

<define container="new-feature">
  <eval><rli>
   <dl><dt><b><font size='+1'>&_.name;</font></b></dt>
      <dd>&_.contents:none;</dd>
   </dl>
   </rli></eval>
</define>



<h1>Release notes for Roxen 2.2</h1>


<h2>User level changes</h2>


<rul>

<new-feature name='Configuration interface changes'>
<b>'content boxes'</b> added in the config interface (the first page)

    If you want to write your own boxes, see the files in
    <i>config_interface/boxes</i>.
<p>

<b>Added memory to the toplevel tabs</b> in the configuration interface
   When you click on a toplevel tab, you return to the page you last visited below that tab, just like in Roxen 1.3, click again to go to toplevel

<p>
<b>The configuration interface now works with more browsers</b>

Some HTML changes were made so that the configuration interface works
better with the Mozilla and Opera browsers.

<p>

<b>The ports tab has been merged into the site tabs</b>, the old
(overview) ports tab is available under the globals tab.

<p>

<b>Two new themes added</b> Square orange, and the new default theme
(old default now known as '2.0 and 2.1 theme').

<p>
</new-feature>


<new-feature name="Built-in MySQL Database">
<p>
 Roxen WebServer now comes bundled with MySQL, and the 
 database is used for various things inside Roxen Webserver. Also, there is a
 new <a href='dbs/'>database administration interface</a> available
 inside the configuration interface.
</p>
</new-feature>


<new-feature name='New User-database and Authentication module system'>
The user-database and authentication module API has been redesigned.

<p> You can now have multiple user database and multiple authentication
modules, and the modules only has to implement one of the two services.

<p> Two example authentication modules are included, one that uses
cookies and one that use the normal 'Basic' authentication system.

<p> Two user database modules are currently available (unless you
count the htaccess module), the system user database and the ldap user
database. The system database uses getpwent on to access the normal system
users.
</new-feature>

<new-feature name='Improved security patterns and htaccess support'>
<p>
The module level security patterns and the htaccess files now include
many new options, and are compiled for quicker execution.
</p>

The htaccess module now also acts as a user-database, so you can use
<tt>&lt;if&nbsp;user=username&gt;</tt> in your RXML pages (and, if you feel
like it, your module level security patterns) with users and groups
authenticated from the htaccess module, even if the page does not
otherwise use the htaccess permission system.
</new-feature>

<new-feature name='Major protocol module changes'>
<dl>
<dt><b>Gopher and fhttp removed</b>
<dd>The gopher and fhttp protocols has been removed. The former
because it has not worked for three years, and nobody noticed, and the
latter because it did only offer benchmark performance, it was not all
that useful for real life applications. However
<p>
<dt><b>HTTP protocol module has some C-optimizations</b>

<dd>Parts of the normal HTTP protocol module has been rewritten in C,
and some other optimizations has been done. Overall, the HTTP parsing
is now about twice as fast as it was in Roxen 2.1.
<p>
<dt><b>The HTTP protocol auto-encodes unicode</b>

<dd>Unicode characters in text data is now recoded to useable output charset. 
This includes recoding of unsupported characters to entities (as an
    example, when a $B6b(B character is encountered and the output charset
    is iso-8859-1, or å and the output charset is iso-8859-9)
<p>
</new-feature>

<new-feature name='Changes in the generic image cache'>
<ul>
  <li>The URLs for the images in the image cache are now encrypted
  before they are sent to the client. 

  <li>The user ID is now saved for the images, no authenticated user
  can get an image rendered for another authenticated user.
</ul>
</new-feature>

<new-feature name='New generic arguments for the image-related tags'>
  <ul>
 <li> <b>span-width</b> and <b>span-height</b>. Like max-width and max-height, but if the image is smaller, it's padded to the specified size.

<li><b>crop=guides-cross</b> <b>guides-index=x,y</b>: Crop
  <i>around</i> the point specified by the intersection of the two
  guides. Useful with max-width=... and max-height=..., primary for
  thumbnail generation.

<li><b>crop=guides-region [guides-index=x1,y1[-x2,y2]]</b>
  Crop to the
    specified region before doing any scales. Also useful with
    max-width=... and max-height=... for thumbnail generation. If
    guides-index is x1,y1, the guides x1,y1 and x1+1,y1+1 will be
    used, counting from the left and the top, respectively.  If both
    the ending and starting indexes (x2,y2) are specified, thoose
    guides will be used.
  </ul>
</ul>
</new-feature>

<new-feature name='Font handling changes'>
 FreeType 2 support added. Roxen can now render text using TrueType
 and PostScript Type1 fronts using FreeType 2.

<p>There are now more CIF (Compact Image Font) generation and
unpacking programs available in the bin directory.
</new-fetaure>

<new-feature name='New start script NT compatibility option'>
 The option <b>--strip-backslash</b> has been added. This causes all \
 in the URL to be transformed to /. Useful for NT-compatibility reasons
 on Unix, this behaviour has been the default on NT since Roxen 2.0.
</rul>

<h2>RXML changes</h2>

<rul>
<new-feature name='Optimizations'>
The RXML parser has been optimized
</new-feature>

<new-feature name='P-Code'>

 RXML is now compiled to P-Code the first time it's run, then
 evaluated directly from this form on subsequent accesses to the same
 file. This means that the RXML does not have to be reparsed from the
 source code for each access.
</new-feature>

<new-feature name='Type system implemented'>
 The RXML parser can now handle any type of data in entities and as
 return value/arguments to tags. This is not widely used yet, but will
 be in the future.
</new-feature>

<new-feature name='Entity indexing'>
Entities holding complex data types (lists of values etc) can now be
indexed using the <tt>&amp;scope.variable.index;</tt> syntax. As an
example, if the page requested has two form variables with the name
<tt>'file'</tt>, you can access them one at a time as
<tt>&amp;form.file.1;</tt> and <tt>&amp;form.file.2;</tt>, respectively.
</new-feature>

<new-feature name='Emit extended'>
Emit now supports more filtering and sorting options
</new-feature>

<new-feature name='Set and append'>
Set and append can now act as container tags, with the value inside them. As an example, to set the variable var.foo to bar, you can use <tt>&lt;set variable=foo&fr;bar&lt/set&gt;</tt>
</new-feature>

<new-feature name='Insert can now insert the "closest" file with a certain name'>
A new argument has been added to &lt;insert&gt; and &lt;use&gt;:
locate=filename. This will attempt to locate the specified file in the
directory the current file recides and all directories above that
directory, up to the root of the virtual filesystem.
</new-feature>

<new-feature name='The expr argument is now more powerful'>

The expr argument (expression evaluation) can now handle much more
complex expressions. As an example, it can do type conversions, and
use complex datatypes.
</new-feature>

</rul>

<h2>New modules</h2>

<rul>
<new-feature name='New image related module, GXML'> 
There is a new image generating module available, the GXML module. It
renders images from a XML language, and is quite easily extended with
new tags and operations (Roxen modules can add tags to GXML).

<p>
See the <a href='http://community.roxen.com/projects/webserver2.2/gxml1.html'>following examples</a> for some more information
</new-feature>

<new-feature name='Email module'>
 A module for creating and sending mails.<br />
<ul>
<li> Mail is sent by SMTP protocol to the remote or local SMTP server. </li>
<li> Multiple headers. </li>
<li> MIME compliant. </li>
<li> Attachments. </li>
</ul>
</new-feature>

<new-feature name='Writefile'>
 A module that allows the creation of files from normal RXML using the
 &lt;writefile&gt; tag.
</new-feature>

<new-feature name='robots.txt generator'>
  Generates a robots.txt on demand from various information. 
</new-feature>
<new-feature name='Word highlighter'>
  Highlights the words stored in the form variable <tt>highlight</tt> in
  HTML pages, mostly useful for searchengines.
</new-feature>

<new-feature name='Whitespace sucker'>
  This module removes redundant whitespace from HTML pages.
</new-feature>

<new-feature name='Session tag'>
  A session state handling system.
</new-feature>

<new-feature name='Sizer'>
This module provides the <tt>&lt;page-size&gt;</tt> tag that 
 calculates the size of a page, including inline images, HTTP headers
 etc, and gives an estimates of the time it will take to download the
 page over various connections.<p> You can also use the <i>size</i>
 prestate to trigger the sizing process.
</new-feature>


<new-feature name='Table/Image Border Unveiler'>
Another helping module for HTML-writers. This one allows you to toggle the viewing of table and image borders using a prestate.
</new-feature>

<new-feature name='Implicit &lt;use&gt;'>
  Automatically &lt;use&gt; a package before parsing files.
<p>
  Useful for creating template files whose tags and variables are
  automatically included before any RXML parsing is done of the
  content files.
</new-feature>

<new-feature name='Javascript support module'>
This module provides some tags to support javascript development (as
an example, Javascript popup menus)
</new-feature>

<new-feature name='Simple MPEG streaming server'>
  A simple mpeg streaming server has been added, mostly for example purposes.
</new-feature>

</rul>




<h2>News for developers</h2>

<rul>
<dt><b>Hilfe protocol</b>

<dd>A Hilfe (interactive pike evaluator) protocol has been added.
    You can use this to evaluate Pike expressions inside your running
    Roxen Server.


<dt><b>Protocol modules are found dynamically</b>
<dd>When Roxen starts, it search for protocol modules in the
'protocols' directory, there is no longer any hard-coded list of known
protocols.
</dl>
<p>
DB
<p>
  Two new APIs are available to module programmers. For more
  information, see the
<a href='https://community.roxen.com/articles/014_db/'>Roxen Community article</a>
</p>
</rul>

<h2>Pike changes since Pike 7.0</h2>

<rul>
<new-feature name='The Crypto module is always included'>
This includes SSL, complete with SSL client support.
</new-feature>

<new-feature name='New refdoc system'> There is now a lot of inlined
documentation in the source-files, and an extractor to convert it to
XML. This is also used in Roxen.
</new-feature>

<new-feature name='Implicit lambda syntax'>

<pre>   function( arguments ) { block };</pre>

   The function will be called with an extra argument (the block as a
   lambda function) as it's argument.

   As an example, you can write:

<pre>   thread_create() {
     while( 1 ) { write("I am a thread\n"); sleep( 1 ); }
   };
</pre>
</new-feature>


<new-feature  name='#pike'>

  Pike files can now be identified with which version of pike they
  where written for with the preprocessor directive #pike. The Pike
  interpreter can then use the apropriate compatibility features.

<p>

  Note that this can also be used for older versions of Pike; a
  Pike 7.0 or 0.6 script won't take offence just because you add a
  #pike line in the beginning of it but it will give 7.2 or later
  versions of pike a fair chance of running it witout complaining
  about incompatible changes to pike that were introduced later. By
  running the pike with a -V 7.0 (or 0.6 in the example given), you
  explicitly tell the compiler to assume compatibility mode of the
  given version, except where overridden by other #pike directives.

</new-feature>               


<new-feature name='--features'>
 The pike binary can be started with the flag --features
 which will make it return a list of all "features"
 available. The subjective definition of a feature is
 something that depends on an external library, special
 features in the OS/hardware or extra compile options.

<p>

  More or less the same information is also available as an task in
  the 
<a href='actions/?action=feature_list.pike&class=debug_info'>configuration
  interface.</a>
</new-feature>


<new-feature              name='--info'>

  The --info flag shows, in addition to the feature list, some version
  and environment information about the pike binary. An example:

<pre>
     Software......Pike
     Version.......Pike v7.2 release 30
     WWW...........http://pike.idonex.se/
     Main author...Fredrik Hübinette
     
     pike binary.../export/d1/nilsson/pike/7.2.30/bin/pike
     master.pike.../export/d1/nilsson/pike/7.2.30/lib/master.pike
     Module path.../export/d1/nilsson/pike/7.2.30/lib/modules
     Include path../export/d1/nilsson/pike/7.2.30/lib/include
     Program path..
     
     Features......dynamic_modules
                   threads
                   out-of-band_data
                   Crypto
                   GL
                   GTK
                   Gdbm
                   Gmp
                   Gz
                   Image.JPEG
                   Image.GIF
                   Image.TIFF
                   Image.TTF
                   Image.PNG
                   Java
                   Mird
                   Mysql
</pre>
</new-feature>

               

<new-feature name='All constructor/destructor and operator overloading functions (LFUNs) may now be static.'>

               Callbacks used for overloading, as well as create and
               destroy, may now be declared as static.
</new-feature>
               

<new-feature name='Improved error diagnostics.'>
     The Pike compiler will now provide better error messages, i.e. 
     more specific than "parse error" in many more cases than before.
</new-feature>
               

<new-feature name='Improved optimization.'>
   The global tree optimizer now performs parse tree transformations
   such as strength reduction. Many new low-level optimizations has
   also been done, such as tail recursion optimization is now applied
   in more cases.
<p>
  search() et al are now faster than before.
<p>
  Also, the Pike compiler itself is now 50% faster than before.
</new-feature>
               

<new-feature name='Labeled break and continue.'>
   Loops can now be labeled and referenced to from break
   and continue. Example:

<pre>
            int a, b;
          foo:
            for (int i = 1; i &lt;= 4; i++) {
              a = i;
              switch (1) {
                case 1:
                  if (i &gt;= 3) break foo;
                  if (i &gt;= 2) continue foo;
              }
              b = i;
            }
            return ({a, b}); // Returns ({3, 1})

</pre>

               

<new-feature   name='Local variables at the same nesting depth may no longer overlap.'>

      This is a return to the behavior of Pike 0.6. (We promise not to
      change it again...) This may cause some compatibility problems
      with Pike 7.0 code. (See the #pike feature above)
<p>
      As an example, the following code is no longer valid:

<pre>
      int a = 10;
      int a = 20;
</pre>
               

<new-feature name='The GC has been rewritten'>
 Most of the GC has been rewritten from scratch. It now has a more
 well defined behaviour.
</new-feature>

<new-feature name='the Simulate module is gone'>
  If you actually need Simulate, use #pike 7.0 and it will appear.
</new-feature>
               

<new-feature name='SQL sprintf style arguments'>


     It is now possible to make sprintf style SQL queries with
     automatic, database specific quoting. Example:

<pre>
  db->query("SELECT * FROM things WHERE id > %d AND name LIKE %s",
             lowest, pattern);
</pre>
</new-feature>

<new-feature name='Support for implicit create().'>

               The following two class definitions are equivalent: 
<pre>
                   class Foo 
                   {
                     int a;
                     static string b;

                     static void create(int _a, string _b) 
                     {
                       a = _a;
                       b = _b;
                     }
                   }

                   class Foo(int a, static string b) 
                   {
                   }
</pre>
</new-feature>

               

<new-feature name='Support for local constants.'>

               Constants can now be defined inside functions.
</new-feature>
               

<new-feature name='Support for the local::id syntax.'>

   Makes it possible to resolve symbols in the local scope. Example: 
<pre>
                   class A {

                     int foo() { return 1; }
                     int bar() { return foo(); }
                     int baz() { return local::foo(); }
                   }

                   class B {
                     inherit A;

                     int foo() { return 2; }
                   }
</pre>
               B()->bar() will return 2 while B()->baz() returns 1.
</new-feature>
               

<new-feature name='type_of() and _type_of() now return the type type.'>
         Example: 

<pre>
        constant boolean = typeof(0)|typeof(1);
        boolean flag = 1;
                    
        int main( int argc, array(string) argv )
        {
           flag = (argc>1)?(int)argv[1]:flag;
           write( "Type of flag is %O\n", typeof(flag) );
           write( "Value of flag is %O\n", flag );
           return 0;
        }
</pre>
</new-feature>

               

<new-feature name='typedef syntax added.'>

               Example: 
<pre>
   typedef int(0..1) boolean;
   boolean flag = 1;
   
   int main( int argc, array(string) argv )
   {
     flag = (argc>1)?(int)argv[1]:flag;
     write( "Type of flag is %O\n", typeof(flag) );
     write( "Value of flag is %O\n", flag );
     return 0;
   }
</pre>
</new-feature>


               
<new-feature name='enum syntax added.'>

               Example: 
<pre>
    enum boolean {
       false,true
     }
     boolean flag = true;
</pre>
</new-feature>


<new-feature name='Added array Regexp match.'>
       Example: 
    
     <tt> Regexp("[0-9]+")->match( ({ "hello", "12", "foo17" }) );</tt><br />
      Returns ({ "12", "foo17" })
</new-feature>


<new-feature name='ADT.Stack'>
  A simple stack implementation. Previously known as Stack.
</new-feature>
               

<new-feature name='Cache'>
               Plugin-based generic caching system, supporting chain-deletion of records.
               Currently supported storage areas are RAM, GDBM, Yabu or MySQL databases,
               removal policies are explicit remove, time-constrained, size-constrained,
               combined.

</new-feature>               

<new-feature name=' Calendar '>
        The new Calendar module. There is a big <a
        href='http://community/_internal/cvsview!0/10257/1.7/0/FAQ'>FAQ</a>
        in its directory describing many of its capabilities.
</new-feature>

               

<new-feature name='Calendar_I '>
  The old Calendar module. Available as Calendar when #pike 7.0 is used.

</new-feature>
               

<new-feature name='Crypto.aes / Crypto.rijndael'>

    Rijndael is a block cipher, designed by Joan Daemen and Vincent
Rijmen, which was the winning candidate algorithm for the AES
(<a href='http://csrc.nist.gov/encryption/aes/'>http://csrc.nist.gov/encryption/aes/</a>). The cipher has a variable block length and key length.
</new-feature>

               

<new-feature name='Crypto.md2'>
The MD2 Message-Digest Algorithm, as defined in RFC 1319
    (http://community.roxen.com/developers/idocs/rfc/rfc1319.html).

</new-feature>
               

<new-feature name='Geography'>

 Capable of converting between symbolic names for the countries to
the actual country name. It can convert between differnet kinds of
position systems such as longitude/latitude, UTM and Georef. The
conversion can be done on any type of ellipsoid. 18 of the most common
earth approximations are included.
</new-feature>
               

<new-feature name='Image.FreeType '>
   Very low-level support for FreeType 2.0, basically maps
   directly to the library. Inside Roxen it's much easier to use the
   built-in font support which wraps the low-level font handlers with
   a somewhat more userfriendly abstraction layer
</new-feature>

               

<new-feature name='Math.Angle'>

 For easy use of angles in computations. It can handle degrees,
radians and gons and conversion between them. You can reference a
degree angle with degrees, minutes and seconds. Includes methods for
normalization, trigonometrical calculations etc.
</new-feature>

               

<new-feature name='Mird '>

 Glue module to libmird, a free simple database with transactions,
see <a
href='http://www.mirar.org/mird/'>http://www.mirar.org/mird/</a>
</new-feature>

               

<new-feature name='PDF'>

 This is a glue module to pdflib,a "half-free" PDF generating
library. This is not included in the binary releases for licensing
reasons.
</new-feature>

               
<new-feature name='Parser.XML.DOM '>

 An implementation of DOM Level 1. See http://www.w3.org/DOM/.
</new-feature>

               

<new-feature name=' Parser.XML.Tree '>

 An easy to use, lightweight module to traverse and manipulate XML
trees.
</new-feature>

               

<new-feature name=' Protocols.HTTP '>

    The API functions in Protocols.HTTP now take their URLs either as
    strings or Standards.URI objects. You also no longer need to set
    the authorization header on your own, if your URL contains
    user:password information (e g
    http://user:password@some.host.com/). Also, the convenience
    functions in this module now handles https URLs.

</new-feature>
               

<new-feature name='Protocols.IRC '>

               A client implementation of the IRC (Internet Relay Chat) protocol.
</new-feature>

               

<new-feature name='Protocols.SNMP '>

 Implements SNMP v1, according to RFC 1157:
<a href='http://community.roxen.com/developers/idocs/rfc/rfc1157.html'>http://community.roxen.com/developers/idocs/rfc/rfc1157.html</a>
</new-feature>

               

<new-feature name='Standards.ISO639_2 '>

 A module providing mapping from ISO-639-2 language codes to
language names and vice versa.
</new-feature>

               

<new-feature name='Standards.URI '>

 Abstract class for URI:s (or URL:s) that both handles indexing
out/altering the various individual components of a URI and correct
resolving/reresolving of a URI with respect to another base URI, all
according with RFC 2396:
               <a href='http://community.roxen.com/developers/idocs/rfc/rfc2396.html'>http://community.roxen.com/developers/idocs/rfc/rfc2396.html</a>
<p>

 Protocols.HTTP now also accepts Standards.URI objects
 as input to all methods that previously used to accept
 only URL strings.
</new-feature>

               

<new-feature name='Stdio.Stat '>

    file_stat() and fdobj->stat() now returns Stdio.Stat objects
    instead of arrays. These objects emulate the behaviour of the
    previously used arrays, but also provide an easier to use
    interface. (See the #pike feature above)
</new-feature>

               

<new-feature name='Tools.AutoDoc '>

 Extracts the new inline documentation format. We will post more
information on this when this system has matured enough to build
working pike reference manuals. Some information is available in files
.autodoc_inlining and .autodoc_syntax in the top directory.
</new-feature>

               

<new-feature name='  system '>

 A module housing various operating system calls made available to
pike that previously used to be provided as efuns (hardlink, symlink,
resolvepath, umask, chmod, chown, chroot stc.). Be prepared to see
these efuns disappear to compat mode only in the future. They will,
however, of course be available in the system module.
</new-feature>

</rul>


<pre>
Quick (not yet finished) newsitems

o built-in testsuite (accessible via start --self-test)

o A bit more internal-magic. /internal-roxen-pixel-foo generates a
  pixel with the color foo.

o Minimum bandwidth - new method to detect and dispose of hung clients.

o Session support

o Several caches less overambitious

o Performance improvements in throttling support

o -DAVERAGE_PROFILING, useful for profiling.
  
o API
  o Roxen.http_try_again( delay )
  o id->url_base()
  o roxen.background_run / roxen.BackgroundProcess API
  o id->real_variables vs. id->variables
  o Currently totally unused plugin support for the arg-cache system.
  o Roxen.compile_rxml Roxen.eval_p_code

o Modules



o FTP
  o Implemented RFC 2428 (EPRT & EPSV).
  o MLSD bugfix

o Java
  o Java patches by Tom Palmer applied.
      Added cookies, prestates and time to the request object.
      Added cache() method.
      Allow module loading from paths beginning with ../
      Provider module fix.

o NT
  o New service
</pre>
 



</blockquote><br />
</charset>
</content>


