<topmenu base="../" selected='sites'/>

<content>
<cv-leftside></cv-leftside>
<cv-split>
<subtablist><st-page>
<br />
<blockquote>

<define variable='var.common'>
<font color='&usr.warncolor;'>&var.error;<br /></font>
  <b>Site name:</b>
   <input name="name" value="&form.name;" /><br />
  <blockquote>
The name of the configuration must contain characters
other than space and tab, it should not end with
~, and it must not be 'CVS', 'Global Variables' or
'global variables', nor the name of an existing
configuration, and the character '/' cannot be
used. This name will show up in the sites menu, a
lowercased, filesystem-friendly version will become
the virtual server's configuration file name as well
as the name of its log file directory.
</blockquote>

<set variable="var.create_txt">Create new site</set>
<set variable="var.template_txt">with template</set>

<submit-gbutton2 width='230' align_icon='right' icon_src='&usr.next;'
name="new_with_template">&var.create_txt; &var.template_txt;</submit-gbutton2>
<br />
<submit-gbutton2 width='230' align_icon='right' icon_src='&usr.next;'
name="new">&var.create_txt;</submit-gbutton2>
<br />
<cf-cancel href="./"/>
</define>

<if variable="form.name">
  <define variable="var.error" preparse="1"><insert file='verify_site_name.pike' nocache='1' /></define>
   <if not="1" variable='var.error is error'>
     <if variable='form.new_with_template..x'>
        <define variable="form.name" preparse="1"><insert file='encode_form_name.pike' /></define>
        <redirect to='create_site_with_template.pike?name=&form.name:http;'/>
     </if>
     <if variable='form.new..x'>
        <insert file='create_site.pike'/>
        <redirect to='site.html/&form.name:http;/' />
     </if>
     <else>
       <eval>&var.common:none;</eval>
     </else>
     <true/>
   </if>
</if>
<if variable='var.error is error'><define variable="var.error" preparse="1">Illegal site name</define><set variable="var.go" value='1' /></if>
<if not="1" variable='form.name'><set variable="var.go" value='1' /></if>
<if variable='var.go'>
   <eval>&var.common:none;</eval>
</if>

</st-page>
</subtablist>
</cv-split>
</content>