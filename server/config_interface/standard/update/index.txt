
<define tag="cat-list" scope="cat">
  <br />
  <table bgcolor="&usr.obox-titlebg;" width="100%">
    <tr><td><font size="+1" color="&usr.obox-titlefg;"><b>&_.title;</b></font></td></tr>
  </table>
  <rul>
  <update-package type="&_.name;" limit="5">
    <eval><rli>&_.title; <a href="update.html?page=details&details=&_.id;">[Details...]</a></rli></eval>
    <set variable="var._&cat.name;" value='foo'/>
  </update-package>
  </rul>
  <if not variable="var._&_.name;">
     &nbsp; Currently no packages in this category.<br />
  </if>
  <else>
    <a href="update.html?page=category&category=&_.name;">[More..]</a><br />
  </else>
  &nbsp;
</define>


<if variable="form.install">
  <redirect to="/standard/update.html?page=install&install=&form.install;" />
</if>


<if variable="form.download">
  <update-start-download package="&form.details;" />
  <redirect to="/standard/update.html?bar" />
</if>

<if variable="form.uninstall_package">
  <update-uninstall-package package="&form.uninstall_package;">
</if>


<h1>Roxen Update System</h1>

<if variable="form.update_list">
  <update-update-list/>
  <update-scan-local-packages/>
  Launched a package list update request.<br />
</if>

This information was last synchronized with the main server &var.last_updated; ago.

<cat-list name="idonex" title="Products" />
<cat-list name="security" title="Security fixes" />
<cat-list name="bugfixes" title="Bug fixes" />
<cat-list name="3rdpart" title="Third party modules" /> 


<?comment --- Information boxes ------------------------- ?>

<define variable="var.dip" preparse="">
  <update-download-progress>
  <tr>
    <td nowrap="nowrap">&_.title;
      <a href="update.html?details=&_.id;">[Details...]</a></td>
    <td nowrap="nowrap">&_.size;</td>
    <td nowrap="nowrap">&_.progress;%</td>
  </tr>
  </update-download-progress>
</define>

<define variable="var.dp" preparse="">
  <update-downloaded-packages>
  <tr>
    <td nowrap="nowrap">&_.title;
      <a href="update.html?page=details&details=&_.id;">[Details...]</a></td>
    <td nowrap="nowrap">&_.size;</td>
    <td nowrap="nowrap">
      <a href="update.html?install=&_.id;">[Install...]</a>
    </td>
  </tr>
  </update-downloaded-packages>
</define>

<set variable="var.both" from="var.dip" />
<append variable="var.both" from="var.dp" />

<if sizeof="var.both > 8">
<hr size="1" width="95%" />
<table>
<tr valign="top">

<if sizeof="var.dip > 4">
<td>
  <cv-obox title="Downloads&nbsp;in&nbsp;progress">
    <table cellpadding="4">
      <tr>
	<td nowrap="nowrap"><b>Description</b></td>
	<td nowrap="nowrap"><b>Size</b></td>
	<td nowrap="nowrap"><b>Downloaded</b></td>
     </tr>
     &var.dip:none;
    </table>
  </cv-obox>
</td>
</if>
<if sizeof="var.dp > 4">
<td>
  <cv-obox title="Downloaded&nbsp;packages">
    <table cellpadding="4">
      <tr>
	<td nowrap="nowrap"><b>Description</b></td>
	<td nowrap="nowrap"><b>Size</b></td>
	<td nowrap="nowrap"></td>
      </tr>
      &var.dp:none;
    </table>
  </cv-obox>
</td>
</if>
</tr></table>  
</if>
