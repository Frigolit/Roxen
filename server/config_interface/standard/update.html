<topmenu selected="home"/>

<content>
<cv-leftside>
  <img src="internal-roxen-unit" height="26" />
  <br />
  <update-sidemenu/>
</cv-leftside>

<cv-startpage><br />


<define tag="package-box">
  <cv-obox title="&_.title;">
  <rul>
  <update-package-output type="&_.name;">
    <rli>#title# <a href="update.html?details=#id#">[Details...]</a></rli>
    <cset variable="_&_.name;">foo</cset>
  </update-package-output>
  </rul>
  <if not variable="_&_.name;">
     <p>Currently no packages in this category</p>
  </if>
  <div align="right">
    <a href="update.html?category=&_.name;">[More..]</a>
  </div>
  </cv-obox>
</define>

<define container="headline">
<table bgcolor="&usr.obox-titlebg;" width=100%>
  <tr>
    <td><font size=+1 color="&usr.obox-titlefg;"><b><contents></b></font></td>
  </tr>
</table>
</define>


<define tag="cat-list">
  <br />
  <headline>&title;</headline>
  <rul>
  <update-package-output type="&name;" limit="5">
    <rli>#title# <a href="update.html?details=#id#">[Details...]</a></rli>
    <cset variable="_&name;">foo</cset>
  </update-package-output>
  </rul>
  <if not variable="_&name;">
     Currently no packages in this category.<br>
  </if>
  <else>
    <a href="update.html?category=&name;">[More..]</a><br>
  </else>
  &nbsp;
</define>


<if not variable="category">
<if not variable="install">
<if not variable="details">
  <cset variable="category"></cset>
</if>
</if>
</if>

<define tag=item>
  <tr valign=top>
    <td align="right"><b>&title;:</b></td>
    <td>#&name;#</td>
  </tr>
</define>


<comment> ================ Show details page ================== </comment>

<if variable=details>
  <if variable="download">
    <update-start-download package="&form.details;" />
    <redirect to="/standard/update.html?bar" />
  </if>

<update-package-output package="&form.details;">
<headline>#title#</headline>
</update-package-output>
<update-package-output preparse package="&form.details;">
<table>
  <item title="Description" name="description">
  <item title="Size" name="size">
  <item title="Organization" name="organization">
  <item title="Author" name="author-name">
  <item title="License" name="license">
  <item title="Date" name="date">
</table>
</update-package-output>

<update-package-is-downloaded package="&form.details;" variable=downloaded>
<if not variable="downloaded">
  <input type="hidden" name="details" value="&form.details;" />
  <input type="submit" name="download" value="Download this package" />
</if>
<else>
  <input type="hidden" name="install" value="&form.details;" />
  <input type="submit" name="do_install" value="Install this package" />
</else>
</if>

<comment> ================ Show start page ================== </comment>

<if variable="category is ">

<h1>Roxen Update System</h1>

<if variable="update_list">
  <update-update-list/>
  <update-scan-local-packages/>
  Launched a package list update request. <br>
</if>

This information was last synchronized with the main server &update.last_updated; ago.

<cat-list name="idonex" title="Products" />
<cat-list name="security" title="Security fixes" />
<cat-list name="bugfixes" title="Bug fixes" />
<cat-list name="3dpart" title="Third party modules" /> 


<hr size="1" width="95%" />
<table>
<tr valign=top>
<td>

  <cv-obox title="Downloads in progress">
    <table cellpadding="4">
      <tr>
	<td nowrap="nowrap"><b>Description</b></td>
	<td nowrap="nowrap"><b>Size</b></td>
	<td nowrap="nowrap"><b>Downloaded</b></td>
     </tr>
     <update-download-progress-output>
     <tr>
       <td nowrap="nowrap">#title#
         <a href="update.html?details=#id#">[Details...]</a></td>
       <td nowrap="nowrap">#size# kB</td>
       <td nowrap="nowrap">#progress#%</td>
     </tr>
     </update-download-progress-output>
    </table>
  </cv-obox>
</td>
<td>
  <cv-obox title="Downloaded packages">
    <table cellpadding="4">
      <tr>
	<td nowrap="nowrap"><b>Description</b></td>
	<td nowrap="nowrap"><b>Size</b></td>
	<td nowrap="nowrap"></td>
      </tr>
      <update-downloaded-packages-output>
      <tr>
        <td nowrap="nowrap">#title#
          <a href="update.html?details=#id#">[Details...]</a></td>
        <td nowrap="nowrap">#size# kB</td>
        <td nowrap="nowrap">
          <a href="update.html?install=#id#">[Install...]</a>
        </td>
      </tr>
      </update-downloaded-packages-output>
    </table>
  </cv-obox>
</td></tr></table>  

</if>

<comment> ================ Show install page ================== </comment>

<if variable="install">

<if variable="no">
foobar
  <redirect to="/standard/update.html?foo" />
</if>
<if variable="yes">

<update-install-package package="&form.install;">

</if>
<else>

<h1>Install package</h1>

<update-package-output preparse package="&form.install;">
<table>
  <item title="Description" name="description">
  <item title="Organization" name="organization">
  <item title="Author" name="author-name">
  <item title="License" name="license">
  <item title="Date" name="date">
</table>
</update-package-output>
<br/>
The following files will be installed:<br>

<comment><textarea name=foo rows=12 cols=70></textarea></comment>
<pre><update-package-contents package="&form.install;" /></pre>
<br>
<b>Do you really want to install this package?</b>
<br />
<input type="hidden" name="install" value="&form.install;">
<input type="submit" name="yes" value="   Yes   "/>&nbsp;&nbsp;&nbsp;
<input type="submit" name="no" value="   No   "/>
</if>
</else>

<comment> ================ Show category ==================== </comment>

<if variable="category">
  <if not variable="category is ">
    <package-box name="&form.category;" title="Foo">
  </if>
</if>

</cv-startpage>
</content>
